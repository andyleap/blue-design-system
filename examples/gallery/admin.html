<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Admin - Blue Design System</title>
    <link rel="stylesheet" href="../../design-system.css">
    <link rel="stylesheet" href="../shared/admin-shared.css">
    <link rel="stylesheet" href="../shared/badges-tags.css">
    <style>
        /* Gallery Admin specific styles */
        .admin-container {
            max-width: 1600px;
        }
        
        .upload-area {
            background: var(--color-surface);
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-8);
            text-align: center;
            margin-bottom: var(--space-8);
            cursor: pointer;
            transition: var(--transition-all);
        }
        
        .upload-area:hover {
            border-color: var(--color-primary-500);
            background: var(--color-primary-50);
        }
        
        .upload-icon {
            font-size: var(--text-6xl);
            margin-bottom: var(--space-4);
        }
        
        .upload-text {
            font-size: var(--text-lg);
            color: var(--color-text);
            margin-bottom: var(--space-2);
        }
        
        .upload-hint {
            color: var(--color-text-muted);
            font-size: var(--text-sm);
        }
        
        .gallery-controls {
            display: flex;
            justify-content: between;
            align-items: center;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
            flex-wrap: wrap;
        }
        
        .controls-left {
            display: flex;
            gap: var(--space-2);
            flex: 1;
        }
        
        .search-input {
            flex: 1;
            max-width: 300px;
        }
        
        .filter-select {
            padding: var(--space-2) var(--space-3);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            background: var(--color-surface);
            color: var(--color-text);
            font-size: var(--text-sm);
        }
        
        .admin-gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: var(--space-4);
        }
        
        .admin-gallery-item {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            overflow: hidden;
            position: relative;
            transition: var(--transition-all);
        }
        
        .admin-gallery-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .admin-gallery-item.selected {
            border: 2px solid var(--color-primary-500);
        }
        
        .gallery-item-image {
            width: 100%;
            aspect-ratio: 4/3;
            background: linear-gradient(45deg, var(--color-primary-200), var(--color-secondary-300));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-4xl);
            color: white;
            cursor: pointer;
        }
        
        .item-overlay {
            position: absolute;
            top: var(--space-2);
            right: var(--space-2);
            display: flex;
            gap: var(--space-1);
        }
        
        .overlay-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-all);
            font-size: var(--text-sm);
        }
        
        .overlay-btn.select {
            background: rgba(255, 255, 255, 0.9);
            color: var(--color-text);
        }
        
        .overlay-btn.edit {
            background: var(--color-primary-500);
            color: white;
        }
        
        .overlay-btn.delete {
            background: var(--color-error-500);
            color: white;
        }
        
        .item-details {
            padding: var(--space-4);
        }
        
        .item-title {
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-2);
            color: var(--color-text);
        }
        
        .item-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--text-sm);
            color: var(--color-text-muted);
            margin-bottom: var(--space-3);
        }
        
        .item-tags {
            display: flex;
            gap: var(--space-1);
            flex-wrap: wrap;
        }
        
        .item-tag {
            background: var(--color-primary-100);
            color: var(--color-primary-700);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
        }
        
        .bulk-actions {
            position: fixed;
            bottom: var(--space-6);
            left: 50%;
            transform: translateX(-50%);
            background: var(--color-surface-elevated);
            box-shadow: var(--shadow-xl);
            border-radius: var(--radius-lg);
            padding: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-3);
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-all);
        }
        
        .bulk-actions.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .selection-count {
            font-weight: var(--font-semibold);
            color: var(--color-text);
        }
        
        /* Modal for image editing */
        .edit-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            padding: var(--space-4);
        }
        
        .edit-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .edit-modal-content {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .edit-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
        }
        
        .edit-modal-title {
            font-size: var(--text-xl);
            margin: 0;
        }
        
        .form-group {
            margin-bottom: var(--space-4);
        }
        
        .form-label {
            display: block;
            font-weight: var(--font-medium);
            margin-bottom: var(--space-2);
            color: var(--color-text);
        }
        
        .form-input,
        .form-textarea {
            width: 100%;
            padding: var(--space-3);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-md);
            background: var(--color-surface-variant);
            color: var(--color-text);
            font-family: inherit;
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .edit-modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: var(--space-3);
            margin-top: var(--space-6);
        }
        
        @media (max-width: 768px) {
            .admin-container {
                padding: var(--space-4);
            }
            
            .admin-header {
                flex-direction: column;
                gap: var(--space-4);
                align-items: flex-start;
            }
            
            .gallery-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .controls-left {
                flex-direction: column;
            }
            
            .search-input {
                max-width: none;
            }
            
            .admin-gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
    </style>
</head>
<body data-theme="dark">
    <!-- Header -->
    <header class="header header--sticky header--shadow" id="main-header">
        <a href="../../" class="header__brand">
            <div class="example-header__logo">B</div>
            Gallery Admin
        </a>
        
        <nav class="header__nav">
            <ul class="header__nav-list">
                <li class="header__nav-item">
                    <a href="#" class="header__nav-link header__nav-link--active">Gallery</a>
                </li>
                <li class="header__nav-item">
                    <a href="#" class="header__nav-link">Collections</a>
                </li>
                <li class="header__nav-item">
                    <a href="#" class="header__nav-link">Settings</a>
                </li>
                <li class="header__nav-item">
                    <a href="index.html" class="header__nav-link">View Gallery</a>
                </li>
                <li class="header__nav-item">
                    <a href="../../" class="header__nav-link">Design System</a>
                </li>
            </ul>
        </nav>
        
        <div class="header__actions">
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                <span class="light-only">🌙</span>
                <span class="dark-only">☀️</span>
            </button>
            <div class="header__user">
                <div class="header__avatar">AD</div>
            </div>
        </div>
    </header>

    <!-- Admin Container -->
    <div class="admin-container">
        <!-- Admin Header -->
        <header class="admin-header">
            <h1 class="admin-title">Gallery Management</h1>
            <div style="display: flex; gap: var(--space-3);">
                <button class="btn btn--secondary">
                    <span>📊</span> Analytics
                </button>
                <button class="btn btn--primary" onclick="document.getElementById('fileInput').click()">
                    <span>📤</span> Upload Images
                </button>
            </div>
        </header>

        <!-- Upload Area -->
        <div class="upload-area" onclick="document.getElementById('fileInput').click()">
            <div class="upload-icon">📁</div>
            <div class="upload-text">Drop images here or click to upload</div>
            <div class="upload-hint">Supports JPG, PNG, WebP up to 10MB each</div>
            <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
        </div>

        <!-- Gallery Controls -->
        <div class="gallery-controls">
            <div class="controls-left">
                <input type="text" class="input search-input" placeholder="Search images..." id="searchInput">
                <select class="filter-select" id="categoryFilter">
                    <option value="all">All Categories</option>
                    <option value="nature">Nature</option>
                    <option value="architecture">Architecture</option>
                    <option value="portrait">Portrait</option>
                    <option value="abstract">Abstract</option>
                </select>
            </div>
            <div>
                <button class="btn btn--ghost btn--sm" onclick="selectAll()">Select All</button>
                <button class="btn btn--ghost btn--sm" onclick="clearSelection()">Clear</button>
            </div>
        </div>

        <!-- Admin Gallery Grid -->
        <div class="admin-gallery-grid" id="adminGallery">
            <!-- Gallery items will be generated by JavaScript -->
        </div>

        <!-- Bulk Actions Bar -->
        <div class="bulk-actions" id="bulkActions">
            <span class="selection-count" id="selectionCount">0 items selected</span>
            <button class="btn btn--secondary btn--sm">Add to Collection</button>
            <button class="btn btn--secondary btn--sm">Change Category</button>
            <button class="btn btn--error btn--sm" onclick="deleteSelected()">Delete Selected</button>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="edit-modal" id="editModal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h3 class="edit-modal-title">Edit Image</h3>
                <button class="btn btn--ghost" onclick="closeEditModal()">×</button>
            </div>
            
            <form id="editForm">
                <div class="form-group">
                    <label class="form-label" for="imageTitle">Title</label>
                    <input type="text" class="form-input" id="imageTitle" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="imageDescription">Description</label>
                    <textarea class="form-textarea" id="imageDescription" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="imageCategory">Category</label>
                    <select class="form-input" id="imageCategory" required>
                        <option value="nature">Nature</option>
                        <option value="architecture">Architecture</option>
                        <option value="portrait">Portrait</option>
                        <option value="abstract">Abstract</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="imageTags">Tags (comma-separated)</label>
                    <input type="text" class="form-input" id="imageTags" placeholder="landscape, mountain, outdoor">
                </div>
                
                <div class="edit-modal-actions">
                    <button type="button" class="btn btn--ghost" onclick="closeEditModal()">Cancel</button>
                    <button type="submit" class="btn btn--primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Theme Switcher Module -->
    <script src="../../js/theme-switcher.js"></script>
    
    <script>
        // Gallery data
        let galleryData = [
            { id: 1, title: "Mountain Landscape", category: "nature", icon: "🏔️", date: "2024-03-15", views: "1.2k", tags: ["landscape", "mountain"] },
            { id: 2, title: "Modern Architecture", category: "architecture", icon: "🏢", date: "2024-03-14", views: "890", tags: ["building", "modern"] },
            { id: 3, title: "Portrait Study", category: "portrait", icon: "👤", date: "2024-03-13", views: "2.1k", tags: ["portrait", "person"] },
            { id: 4, title: "Abstract Art", category: "abstract", icon: "🎨", date: "2024-03-12", views: "756", tags: ["abstract", "colorful"] },
            { id: 5, title: "Forest Path", category: "nature", icon: "🌲", date: "2024-03-11", views: "1.8k", tags: ["forest", "path"] },
            { id: 6, title: "City Skyline", category: "architecture", icon: "🌆", date: "2024-03-10", views: "945", tags: ["city", "skyline"] },
            { id: 7, title: "Ocean Waves", category: "nature", icon: "🌊", date: "2024-03-09", views: "1.5k", tags: ["ocean", "waves"] },
            { id: 8, title: "Geometric Forms", category: "abstract", icon: "🔷", date: "2024-03-08", views: "623", tags: ["geometric", "shapes"] },
        ];

        let selectedItems = new Set();
        let currentFilter = 'all';
        let currentSearch = '';

        // Initialize gallery
        function initGallery() {
            renderGallery();
            setupEventListeners();
        }

        // Render gallery items
        function renderGallery() {
            const gallery = document.getElementById('adminGallery');
            let filteredData = galleryData;

            // Apply filters
            if (currentFilter !== 'all') {
                filteredData = filteredData.filter(item => item.category === currentFilter);
            }

            // Apply search
            if (currentSearch) {
                filteredData = filteredData.filter(item => 
                    item.title.toLowerCase().includes(currentSearch.toLowerCase()) ||
                    item.tags.some(tag => tag.toLowerCase().includes(currentSearch.toLowerCase()))
                );
            }

            gallery.innerHTML = filteredData.map(item => `
                <div class="admin-gallery-item ${selectedItems.has(item.id) ? 'selected' : ''}" data-id="${item.id}">
                    <div class="gallery-item-image">${item.icon}</div>
                    <div class="item-overlay">
                        <button class="overlay-btn select" onclick="toggleSelection(${item.id})" title="Select">
                            ${selectedItems.has(item.id) ? '✓' : '◯'}
                        </button>
                        <button class="overlay-btn edit" onclick="editItem(${item.id})" title="Edit">✏️</button>
                        <button class="overlay-btn delete" onclick="deleteItem(${item.id})" title="Delete">🗑️</button>
                    </div>
                    <div class="item-details">
                        <div class="item-title">${item.title}</div>
                        <div class="item-meta">
                            <span>${item.date}</span>
                            <span>${item.views} views</span>
                        </div>
                        <div class="item-tags">
                            ${item.tags.map(tag => `<span class="item-tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');

            updateBulkActions();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search input
            document.getElementById('searchInput').addEventListener('input', (e) => {
                currentSearch = e.target.value;
                renderGallery();
            });

            // Category filter
            document.getElementById('categoryFilter').addEventListener('change', (e) => {
                currentFilter = e.target.value;
                renderGallery();
            });

            // File input
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);

            // Edit form
            document.getElementById('editForm').addEventListener('submit', handleEditSubmit);
        }

        // Toggle item selection
        function toggleSelection(id) {
            if (selectedItems.has(id)) {
                selectedItems.delete(id);
            } else {
                selectedItems.add(id);
            }
            renderGallery();
        }

        // Select all items
        function selectAll() {
            galleryData.forEach(item => selectedItems.add(item.id));
            renderGallery();
        }

        // Clear selection
        function clearSelection() {
            selectedItems.clear();
            renderGallery();
        }

        // Update bulk actions visibility
        function updateBulkActions() {
            const bulkActions = document.getElementById('bulkActions');
            const selectionCount = document.getElementById('selectionCount');
            
            if (selectedItems.size > 0) {
                bulkActions.classList.add('visible');
                selectionCount.textContent = `${selectedItems.size} item${selectedItems.size > 1 ? 's' : ''} selected`;
            } else {
                bulkActions.classList.remove('visible');
            }
        }

        // Edit item
        function editItem(id) {
            const item = galleryData.find(item => item.id === id);
            if (item) {
                document.getElementById('imageTitle').value = item.title;
                document.getElementById('imageDescription').value = item.description || '';
                document.getElementById('imageCategory').value = item.category;
                document.getElementById('imageTags').value = item.tags.join(', ');
                
                document.getElementById('editModal').classList.add('active');
                document.getElementById('editForm').setAttribute('data-item-id', id);
            }
        }

        // Close edit modal
        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        // Handle edit form submission
        function handleEditSubmit(e) {
            e.preventDefault();
            const itemId = parseInt(e.target.getAttribute('data-item-id'));
            const item = galleryData.find(item => item.id === itemId);
            
            if (item) {
                item.title = document.getElementById('imageTitle').value;
                item.description = document.getElementById('imageDescription').value;
                item.category = document.getElementById('imageCategory').value;
                item.tags = document.getElementById('imageTags').value.split(',').map(tag => tag.trim());
                
                renderGallery();
                closeEditModal();
                console.log('Item updated:', item);
            }
        }

        // Delete item
        function deleteItem(id) {
            if (confirm('Are you sure you want to delete this image?')) {
                galleryData = galleryData.filter(item => item.id !== id);
                selectedItems.delete(id);
                renderGallery();
            }
        }

        // Delete selected items
        function deleteSelected() {
            if (selectedItems.size > 0 && confirm(`Delete ${selectedItems.size} selected item${selectedItems.size > 1 ? 's' : ''}?`)) {
                galleryData = galleryData.filter(item => !selectedItems.has(item.id));
                selectedItems.clear();
                renderGallery();
            }
        }

        // Handle file upload
        function handleFileUpload(e) {
            const files = Array.from(e.target.files);
            console.log('Uploading files:', files.map(f => f.name));
            
            // Simulate file upload process
            files.forEach((file, index) => {
                setTimeout(() => {
                    const newId = Math.max(...galleryData.map(item => item.id)) + 1;
                    const newItem = {
                        id: newId,
                        title: file.name.replace(/\.[^/.]+$/, ""),
                        category: 'nature',
                        icon: '📷',
                        date: new Date().toISOString().split('T')[0],
                        views: '0',
                        tags: ['new', 'uploaded']
                    };
                    
                    galleryData.push(newItem);
                    renderGallery();
                }, index * 200);
            });
            
            e.target.value = ''; // Clear file input
        }

        // Initialize everything when page loads
        window.addEventListener('DOMContentLoaded', () => {
            initGallery();
        });

        // Close modal when clicking outside
        document.getElementById('editModal').addEventListener('click', (e) => {
            if (e.target.id === 'editModal') {
                closeEditModal();
            }
        });
    </script>
</body>
</html>